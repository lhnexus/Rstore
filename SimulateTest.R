##########Simulate Data


setwd("D:/Calc/")

source("calculateOtsu.R")
source("drawHist.R")

datas<-list()
thresholds<-list()

#####real data
real=c(0.73663274,0.49468393,0.33556065,0.21810462,0.38698051,0.10324486,0.20218424,0.85171761,0.49034143,1.03627993,0.14722155,0.25431684,0.58229279,1.51356948,0.58576173,0.13570068,0.18124684,0.18517908,0.15370671,0.07098709,0.17824283,0.09806708,0.13547007,0.03489462,0.04343812,0.11418073,0.08067864,0.11860902,0.10135207,0.10247096,0.17145104,0.12422603,0.14238189,0.11454341,0.07020298,0.02868728,0.12562123,0.11105913,0.10504184)

threshold=calculateOtsu(real)

threshold

datas[["real"]]<-real
thresholds[[1]]<-threshold


######simulation data
adata=c(0.73663274,0.49468393,0.33556065,0.21810462,0.38698051,0.10324486,0.20218424,0.85171761,0.49034143,1.03627993,0.14722155,0.25431684,0.58229279,1.51356948,0.58576173,0.13570068,0.18124684,0.18517908,0.15370671,0.07098709,0.17824283,0.09806708,0.13547007,0.03489462,0.04343812,0.11418073)



dataK=runif(1000,min=0.01,max=0.18)

sdataK=c(adata,dataK)

thresholdK=calculateOtsu(sdataK)

thresholdK

datas[["sdataK"]]<-sdataK
thresholds[[2]]<-thresholdK




data10K=runif(10000,min=0.01,max=0.18)

sdata10K=c(adata,data10K)

threshold10K=calculateOtsu(sdata10K)

threshold10K

datas[["sdata10K"]]<-sdata10K
thresholds[[3]]<-threshold10K


data100K=runif(100000,min=0.01,max=0.18)

sdata100K=c(adata,data100K)

threshold100K=calculateOtsu(sdata100K)

threshold100K

datas[["sdata100K"]]<-sdata100K
thresholds[[4]]<-threshold100K



dataM=runif(1000000,min=0.01,max=0.18)

sdataM=c(adata,dataM)

thresholdM=calculateOtsu(sdataM)

thresholdM

datas[["sdataM"]]<-sdataM
thresholds[[5]]<-thresholdM


#data10M=runif(10000000,min=0.01,max=0.18)

#sdata10M=c(adata,data10M)

#threshold10M=calculateOtsu(sdata10M)

#threshold10M

#datas[["sdata10M"]]<-sdata10M
#thresholds[[6]]<-threshold10M



data10M=runif(10000000,min=0.01,max=0.18)

mth=c(1.5)

sdatanew=c(data10M,mth)

threshold10Mnew=calculateOtsu(sdatanew)

threshold10Mnew

datas[["sdatanew"]]<-sdatanew
thresholds[[6]]<-threshold10Mnew



bdata=c(0.09806708,0.13547007,0.03489462,0.04343812,0.11418073,0.08067864,0.11860902,0.10135207,0.10247096,0.17145104,0.12422603,0.14238189,0.11454341,0.07020298,0.02868728,0.12562123,0.11105913,0.10504184)

UdataK=runif(1000,min=0.8,max=1.5)

UdataKAll=c(bdata,UdataK)

thresholdK=calculateOtsu(UdataKAll)

thresholdK

datas[["UdataKAll"]]<-UdataKAll
thresholds[[7]]<-thresholdK


PdataK=runif(1000,min=0.8,max=1.5)

PthresholdK=calculateOtsu(PdataK)

PthresholdK

datas[["PdataK"]]<-PdataK
thresholds[[8]]<-PthresholdK


PdataK=runif(1000,min=0.8,max=1.5)

PthresholdK=calculateOtsu(PdataK)

PthresholdK

datas[["PdataK"]]<-PdataK
thresholds[[9]]<-PthresholdK




NdataK=rnorm(1000,mean=0.09,sd=0.25)

NthresholdK=calculateOtsu(NdataK)

NthresholdK

datas[["NdataK"]]<-NdataK
thresholds[[10]]<-NthresholdK

#####real data2
real2 <-c(0.14503353,0.019685848,0.078909633,0.079352331,0.076505939,0.008985281,0.002106183,0.007908065,0.008357097,0.081047569,0.007514583,0.008225496,0.08070455,0.069415755,0.00776564,0.081011579,0.079435287,0.08127806,0.00765542,0.07973987,0.007949615,0.07975273,0.078702928,0.007368738,0.027300145,0.008784792,0.009449678,0.009938858,0.007687405,0.080771924,0.081324278,0.079317235,0.003792591,0.001871874,0.079848377,0.078458542,0.009584518,0.078821218,0.079529671,0.005435215,0.081017423,0.080003916,0.081262491,0.022533803,0.016020329,0.079180448,0.007913847,0.078120605,0.079278029,0.012935968,0.108147726,0.080707195,0.078648642,0.009280379,0.007786699,0.008004699,0.027577835,0.08212071,0.008671732,0.009555626,0.001744459,0.014494486,0.001766345,0.001885308,0.001904423,0.114404191,0.081415605,0.008451189,0.011757337,0.081508424,0.020318623,0.008546887,0.007987132,0.080629122,0.01776842,0.08117671,0.00866357,0.01103454,0.001864168,0.081258946,0.080423991,0.079435888,0.008986381,0.008646274,0.080094872,0.081320287,0.012517835,0.078842614,0.007835528,0.068045107,0.007563572,0.043830588,0.068359066,0.080703953,0.009044017,0.008696803,0.00217661,0.080275905,0.080203267,0.079488356,0.008461275,0.009196912,0.013444263,0.079400194,0.00850683,0.080143796,0.080745383,0.080527689,0.081550273,0.081374069,0.00661792,0.007483007,0.001932254,0.009296332,0.080978206,0.080898468,0.080310399,0.120523563,0.081932505,0.081620103,0.080955036,0.081871067,0.079826867,0.080920471,0.012073367,0.081091251,0.011814331,0.079984006,0.079877861,0.080720109,0.001875187,0.001871679,0.081298989,0.081407941,0.080063,0.008434263,0.080478224,0.079932524,0.008914174,0.079013331,0.08013137,0.080009245,0.080043257,0.007671699,0.008139215,0.001794111,0.001843049,0.07881682,0.080077677,0.082321022,0.009141309,0.018869245,0.073428811,0.009018267,0.002089696,0.082048186,0.111428226,0.076933484,0.080372254,0.078900543,0.080823086,0.00757558,0.009240603,0.00778452,0.079890966,0.015312869,0.079354851,0.071751018,0.009004095,0.081026513,0.0660892,0.007811346,0.001764782,0.079148669,0.015915094,0.079701735,0.016440214,0.008441918,0.007549453,0.009532716,0.081433984,0.08091229,0.003536651,0.008758796,0.076441521,0.080950191,0.007791892,0.009609419,0.079903505,0.080351712,0.014585761,0.007660474,0.077830379,0.079507896,0.007747226,0.081858209,0.067383318,0.001892488,0.080251664,0.00191033,0.00779471,0.013543558,0.008574316,0.008869003,0.075571797,0.079969442,0.007382458,0.078754308,0.080869317,0.08069986,0.007557849,0.001819367,0.010968587,0.080719324,0.014667729,0.080281063,0.081532955,0.080822518,0.081525858,0.079860925,0.008622763,0.080031349,0.008819899,0.081475369,0.07983656,0.015882055,0.08106999,0.00178611,0.080627963,0.080201559,0.017329033,0.007952851,0.002462644,0.058704277,0.080250899,0.081362852,0.008701312,0.008494723,0.007967428,0.009458468,0.080860118,0.001920977,0.015741189,0.07613208,0.072600564,0.12483544,0.007962424,0.009129321,0.009142279,0.002067665,0.003672895,0.081375517,0.016317167,0.080682047,0.124153781,0.081722733,0.081416408,0.001888106,0.00824313,0.080405644,0.080601392,0.07952411,0.013022115,0.007535451,0.050882386,0.007069566,0.066950294,0.081772605,0.009245195,0.080302603,0.077772361,0.059268326,0.001713161,0.079660042,0.007554283,0.080295705,0.01324561,0.019723436,0.076734747,0.080275006,0.069837487)
threshold2<-calculateOtsu(real2)

threshold2

datas[["RealData2"]]<-real2
thresholds[[11]]<-threshold2

#####real data3
real3 <-c(0.005936691536253044,0.029383826118975522,0.0026731314183920576,0.0035544302408067278,0.005114855939238846,0.0794793125225317,0.02202107097491041,0.053330187027409694,0.03549495828813666,0.011640152712204394,0.003561703354002723,0.0018667905734826122,0.005769275675369493,0.011066679987958173,0.0017774073023745114,0.013943742581894084,0.0024478077889076213,0.02447795820632679,0.08019260463933611,0.07640811366975041,0.022157068519834355,0.016136998760629698,0.019291649577055644,0.0035351808424882365,0.003126468884597569,0.004352923045847689,0.10069063176364396,0.004011753719596263,0.08005897489601563,0.018278833464516142,0.01626967152686445,0.02605761257910753,0.042792652168856846,0.029544504105948232,0.006614687596496789,0.07878364600370487,0.0025492830698442817,0.0018820355898363655,0.011187146688712726,0.07887157484852364,0.008545790104593852,0.020341813825323254,0.04352610339486483)
threshold3<-calculateOtsu(real3)

threshold3

datas[["RealData3"]]<-real3
thresholds[[12]]<-threshold3

#####real data4
real4 <-c(0.000649,0.000743,0.000893,0.001105,0.001364,0.002030,0.026499)
threshold4<-calculateOtsu(real4)

threshold4

datas[["RealData4"]]<-real4
thresholds[[13]]<-threshold4


#####real data5
real5 <-c(0.044817,0.053642,0.059910,0.068719,0.070659,0.110510,0.122818,0.031890,0.000897,0.001829,0.002108,0.002285,0.002625,0.002974,0.003089,0.003480,0.003647,0.003827,0.005318,0.005689,0.006805,0.008330,0.008701,0.009449,0.010254,0.010847,0.010933,0.011374,0.012568,0.013518,0.014120,0.014246,0.018960,0.023367,0.023927,0.024736,0.024843,0.025613,0.027483)
threshold5<-calculateOtsu(real5)

threshold5

datas[["RealData5"]]<-real5
thresholds[[14]]<-threshold5


#####real data6
real6 <-c(0.145033530179587,0.0196858480279886,0.0789096333968425,0.0793523312326405,0.0765059390144169,0.00898528054034697,0.00210618340246646,0.00790806481352954,0.0083570969723703,0.081047568848281,0.0075145830820231,0.008225495864141,0.0807045504794304,0.0694157552128956,0.00776563953332357,0.081011578706604,0.0794352874753075,0.0812780598648503,0.00765542042850992,0.0797398700982232,0.00794961525795878,0.0797527299828089,0.0787029277036612,0.0073687375248057,0.0273001445495764,0.00878479231566531,0.00944967841554299,0.0099388580256165,0.0076874052113082,0.0807719237040355,0.0813242776714281,0.0793172350982612,0.00379259134814779,0.00187187428747039,0.0798483773654888,0.0784585417431815,0.00958451840917789,0.0788212182748303,0.0795296709788173,0.00543521473482706,0.0810174225700752,0.0800039156576507,0.0812624911440241,0.0225338029164145,0.0160203292895019,0.07918044827742,0.00791384743765503,0.0781206045302817,0.0792780289886426,0.0129359681479724,0.108147726271189,0.0807071948894991,0.0786486423186449,0.00928037930372071,0.00778669877552935,0.00800469901261115,0.0275778350264085,0.0821207104062158,0.00867173200703235,0.00955562644457553,0.00174445938794857,0.0144944861391322,0.00176634495753231,0.00188530813473793,0.00190442334289385,0.114404191401181,0.0814156052456467,0.00845118918750263,0.0117573370685039,0.0815084243442631,0.0203186230895689,0.00854688735611875,0.00798713193513841,0.0806291222664209,0.0177684195086242,0.0811767103237632,0.00866356965754702,0.0110345403227318,0.00186416776445951,0.081258946063238,0.080423991423862,0.0794358883610954,0.0089863811065472,0.00864627413944516,0.0800948715529818,0.0813202870979691,0.0125178354394683,0.078842613976052,0.00783552834072507,0.0680451073044589,0.00756357229094409,0.0438305881148846,0.0683590656017093,0.0807039525814669,0.00904401689821859,0.00869680250952542,0.00217661031718422,0.0802759052469327,0.0802032668894355,0.0794883557255007,0.00846127549824849,0.00919691162889706,0.0134442632027668,0.0794001936204523,0.00850683033282606,0.0801437962315539,0.0807453832343191,0.0805276889377026,0.0815502734050376,0.0813740689186563,0.00661791994472628,0.00748300698913465,0.00193225437311182,0.00929633231340514,0.0809782058367395,0.0808984680626859,0.08031039912271,0.120523562555472,0.0819325051178552,0.0816201027477874,0.0809550361554285,0.081871066673898,0.0798268667812099,0.0809204708961242,0.0120733665157946,0.0810912505924428,0.0118143307234386,0.0799840059988895,0.0798778609098505,0.0807201091809945,0.00187518708786848,0.00187167933240906,0.0812989894706709,0.0814079411063612,0.080062999800828,0.00843426255412132,0.0804782243354882,0.0799325244612485,0.00891417351403678,0.0790133308292863,0.0801313697735259,0.080009245298682,0.080043257041703,0.00767169921053798,0.00813921511628833,0.00179411119595459,0.00184304918340645,0.0788168197730131,0.0800776771429441,0.0823210217740327,0.00914130922673744,0.0188692448235714,0.0734288107659574,0.0090182668817702,0.00208969601300758,0.0820481861182735,0.111428226225148,0.07693348421406,0.0803722537958402,0.0789005428522934,0.0808230856292887,0.00757558049482652,0.00924060259481761,0.00778451993241608,0.0798909662445172,0.0153128686471855,0.0793548507705734,0.0717510184803643,0.00900409515789051,0.0810265129490733,0.066089199608936,0.00781134637125495,0.00176478160905364,0.0791486691478207,0.0159150941650766,0.0797017352590993,0.0164402143948696,0.00844191782183508,0.00754945332810191,0.00953271624761856,0.0814339842464704,0.0809122904205278,0.00353665072737366,0.00875879620235301,0.0764415212191577,0.0809501909786209,0.00779189246140155,0.00960941867860818,0.0799035052112897,0.0803517123202217,0.0145857613141959,0.00766047351156617,0.0778303791751494,0.0795078960065614,0.00774722601133061,0.0818582093389596,0.0673833183853288,0.00189248804023324,0.0802516644926035,0.00191032951945689,0.00779471024928142,0.013543557975136,0.00857431585033907,0.00886900277970592,0.0755717972152947,0.0799694422098944,0.00738245788853907,0.0787543075235288,0.0808693168806811,0.0806998597432831,0.00755784925272009,0.00181936709625783,0.0109685868255587,0.0807193243185099,0.0146677290742031,0.0802810625613512,0.0815329553068923,0.0808225183635763,0.0815258582826256,0.0798609248497682,0.00862276326441293,0.0800313491087308,0.00881989910423333,0.0814753688424867,0.079836560175386,0.0158820545683142,0.0810699895114343,0.00178610985539814,0.080627962795894,0.0802015587494689,0.0173290332067475,0.00795285075759408,0.00246264439980261,0.0587042772630208,0.0802508988458035,0.0813628524596221,0.00870131172847676,0.00849472349371938,0.0079674275273598,0.00945846803823739,0.0808601184638165,0.00192097717051894,0.0157411891923509,0.0761320796944075,0.0726005638920688,0.124835440088025,0.00796242435115688,0.0091293208046659,0.00914227911952557,0.00206766506371926,0.00367289465347644,0.0813755167781895,0.016317166748088,0.0806820473317676,0.124153781352607,0.0817227330691923,0.0814164081119699,0.00188810638849618,0.00824312986547958,0.0804056435275764,0.0806013924551006,0.0795241102546031,0.0130221150355897,0.00753545098271762,0.0508823861321223,0.00706956571204055,0.0669502944589324,0.0817726051734259,0.00924519511206322,0.0803026027781317,0.0777723612093124,0.0592683264993938,0.00171316075327422,0.0796600422536837,0.00755428306177496,0.0802957053511156,0.0132456096733093,0.0197234357836495,0.0767347472556571,0.0802750058503769,0.069837487197707))
threshold6<-calculateOtsu(real6)

threshold6

datas[["RealData6"]]<-real6
thresholds[[15]]<-threshold6


#####real data7
real7 <-c(0.003272173868689958,0.003406575942931755,0.0036199980545422884,0.0033551846022306744)
threshold7<-calculateOtsu(real7)

threshold7

datas[["RealData7"]]<-real7
thresholds[[16]]<-threshold7

#############PDF OUTPUT


for(i in 1: length(datas)){
  pdf(paste(names(datas)[i],".pdf",sep=""))
  drawHist(datas[[i]],thresholds[[i]])
  dev.off()
}
  

############PDF OUTPUT TEST
setwd("D:/Calc/")
pdf("realData6.pdf")
drawHist(real6,threshold6)
dev.off()


##########Diagram TEST

par(mflow = c(1,2))
plot(real)
abline(h=threshold)
drawHist(NdataK,NthresholdK)


x<-seq(-1,2,length.out=1000)
y<-pexp(x,0.5)

ythreshold=calculateOtsu(y)
ythreshold

pdf("culmulative.pdf")
drawHist(y,ythreshold)
dev.off()



drawHist(y,ythreshold)


